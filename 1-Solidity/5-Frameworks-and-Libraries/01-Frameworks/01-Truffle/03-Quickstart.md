//-------------------------
//  Truffle Quickstart
//-------------------------

 creating a Truffle project and deploying a smart contract to a blockchain

1- Create a project

    - create a bare project without smart contracts:
        > truffle init
    
    - starting with example applications and project templates:
        > truffle unbox [box-name] [PATH/TO/DIRECTORY]
        > truffle unbox metacoin


    Once this operation is completed, you'll now have a project structure with the following items:

        - contracts/:       Directory for Solidity contracts

        - migrations/:      Directory for migration (deployment) script files

        - test/:            Directory for javascript test files for testing your application and contracts
                            test ensures that your contract is working as expected
                            (Truffle tests can also be writte in typescript)

        - truffle.js:       Truffle configuration file
                            setting network information and other project-related settings

2- Test

    - To run all tests, you can simply run:
        > truffle test

    - You can also run each test individually by calling:
        > truffle test ./test/TestMetaCoin.sol 
        > truffle test ./test/metacoin.js

3- Compile

    > truffle compile

4- Migrate

    - Migrate with Truffle Develop:

        > truffle develop
        > truffle migrate

        By default, truffle migrate will also run truffle compile, so you can just do the migrate

    
    - Migrate with Truffle Console:

        - Open truffle-config.js and edit configuration:

            module.exports = {
                networks: {
                    development: {
                    host: "127.0.0.1",
                    port: 7545,
                    network_id: "*"
                    }
                }
                };

        > truffle migrate

        - To interact with the contract, you can use the Truffle console:
            > truffle console


5- Interact with the contract

    - Interact with the contract using the console

        deployed MetaCoin contract instance:

            > let instance = await MetaCoin.deployed()

        returns a promise which resolves to an array of all the accounts generated by the mnemonic:

            > let accounts = await web3.eth.getAccounts()

        Check the metacoin balance of the account that deployed the contract:

            > let balance = await instance.getBalance(accounts[0])
            > balance.toNumber()

        how much ether that balance is worth

            > let ether = await instance.getBalanceInEth(accounts[0])
            > ether.toNumber()

        Transfer some metacoin from one account to another:

            > instance.sendCoin(accounts[1], 500)

        Check the balance of the account that received the metacoin:

            > let received = await instance.getBalance(accounts[1])
            > received.toNumber()

        Check the balance of the account that sent the metacoin:

            let newBalance = await instance.getBalance(accounts[0])
            newBalance.toNumber()


6- Deploy to Mainnet (or Testnet)

    - Starting a dashboard:

        Truffle Dashboard
        https://trufflesuite.com/docs/truffle/how-to/use-the-truffle-dashboard/

        provide an easy way to use your existing MetaMask wallet for your deployments and for other transactions that you need to send from a command line context. 
        Because the Truffle Dashboard connects directly to MetaMask it is also possible to use it in combination with hardware wallets like Ledger or Trezor.

            > truffle dashboard
    
    - Connecting to the dashboard:

        Truffle includes a built in network named "dashboard" inside "truffle-config.js"

        dashboard: {
            port: 24012,
            networkCheckTimeout: 120000,
        }

        This built in network can be used with all your deployments or scripts.
        http://localhost:24012

            > truffle migrate --network dashboard
            > truffle console --network dashboard

        From there, every Ethereum RPC request will be forwarded from Truffle to the Truffle Dashboard, 
        where the user can inspect the RPC requests and process them with MetaMask.